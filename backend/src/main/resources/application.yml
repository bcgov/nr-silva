# General application
server:
  error:
    include-message: always
  port: ${SERVER_PORT:8080}
  shutdown: graceful
  allowed:
    cors:
      origins: ${ALLOWED_ORIGINS:#{'http://127.*, http://localhost:300*'}}

spring:
  application:
  name: results-api
  oracle:
    jdbcUrl: jdbc:oracle:thin:@tcps://${DATABASE_HOST:nrcdb03.bcgov}:${DATABASE_PORT:1543}/${SERVICE_NAME:dbq01.nrs.bcgov}?javax.net.ssl.trustStore=${ca.bc.gov.nrs.oracle.keystore}&javax.net.ssl.trustStorePassword=${ca.bc.gov.nrs.oracle.secret}&javax.net.ssl.keyStore=${ca.bc.gov.nrs.oracle.keystore}&javax.net.ssl.keyStorePassword=${ca.bc.gov.nrs.oracle.secret}&oracle.net.ssl_certificate_alias=${ca.bc.gov.nrs.oracle.host}&oracle.net.ssl_server_dn_match=false
    url: ${spring.datasource.oracle.jdbcUrl}
    username: ${DATABASE_USER}
    password: ${DATABASE_PASSWORD}
    hikari:
      driver-class-name: oracle.jdbc.OracleDriver
      jdbcUrl: ${spring.oracle.jdbcUrl}
      url: ${spring.oracle.jdbcUrl}
      username: ${spring.oracle.username}
      password: ${spring.oracle.password}
      connectionTimeout: 30000
      idleTimeout: 600000
      maxLifetime: 1800000
      keepaliveTime: 30000
      poolName: SilvaOracleConnPool
      minimumIdle: 1
      maximumPoolSize: 3
      leakDetectionThreshold: 60000
  datasource:
    jdbcUrl: jdbc:postgresql://${POSTGRES_HOST:localhost}:5432/${POSTGRES_DB:nr-silva}
    url: ${spring.datasource.jdbcUrl}
    username: ${POSTGRES_USER:nr-silva}
    password: ${POSTGRES_PASSWORD:default}
    hikari:
      driver-class-name: org.postgresql.Driver
      jdbcUrl: ${spring.datasource.jdbcUrl}
      username: ${spring.datasource.username}
      password: ${spring.datasource.password}
      connectionTimeout: 30000
      idleTimeout: 600000
      maxLifetime: 1800000
      keepaliveTime: 30000
      poolName: SilvaPostgresConnPool
      minimumIdle: 1
      maximumPoolSize: 3
      leakDetectionThreshold: 60000

# Common database settings
  jpa:
    show-sql: false

# FAM
  security:
    oauth2:
      resourceserver:
        jwt:
          issuer-uri: ${AWS_COGNITO_ISSUER_URI:aws-cognito-any-url.com}
          jwk-set-uri: ${AWS_COGNITO_ISSUER_URI:aws-cognito-any-url.com}/.well-known/jwks.json

# Flyway
  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration

# OpenSearch settings
nr-results-ecs-version: 8.9
nr-results-backend-env-opensearch: ${RESULTS_ENV_OPENSEARCH:development}
nr-results-team-email-address: Team.Silva@gov.bc.ca

  
# Actuator and ops
management:
  endpoint:
    health:
      show-details: always

# https://github.com/quarkusio/quarkus/wiki/Migration-Guide-3.2
quarkus:
  native:
    additional-build-args: -march=native

# Certificate for the Database
ca:
  bc:
    gov:
      nrs:
        dashboard-job-users: ${DASHBOARD_JOB_IDIR_USERS:NONE}
        wms-whitelist: ${WMS_LAYERS_WHITELIST_USERS:NONE}
        org-units: ${OPENING_SEARCH_ORG_UNITS:DCK,DSQ,DVA,DKM,DSC,DFN,DSI,DCR,DMK,DQC,DKA,DCS,DOS,DSE,DCC,DMH,DQU,DNI,DND,DRM,DPG,DSS,DPC}
        forest-client-api:
          address: ${FORESTCLIENTAPI_ADDRESS:https://nr-forest-client-api-prod.api.gov.bc.ca/api}
          key: ${FORESTCLIENTAPI_KEY:placeholder-api-key}
        open-maps:
          address: ${OPENMAPS_URL:https://openmaps.gov.bc.ca/geo/ows}
        oracle:
          keystore: ${ORACLEDB_KEYSTORE:jssecacerts-path}
          secret: ${ORACLEDB_SECRET:changeit}
          host: ${DATABASE_HOST:nrcdb03.bcgov}
        limits:
          max-actions-results: ${MAX_ACTIONS_RESULTS:5}

# Logging
logging:
  level:
    ca.bc.gov.restapi.results: ${LOGGING_LEVEL:INFO}